#!/usr/bin/env bash
set -eu

# shellcheck source=./env.globals
source bin/env.globals

sites=""

# echo "======================"
echo -e "${GREEN}Welcome to the ${YELLOW}☲${ORANGE} Firetrak${GREEN} setup!${NC}"
echo "================================"
echo "You will be asked a few questions to help you set up your project."
echo
echo -e "${WHITE}Dev domain${NC}"
echo " - Your local dev domain must be a domain you own, or a subdomain of one."
echo " - Its DNS must be managed by Digitalocean."
echo "If your dev domain is local.domain.dev, a site url will look like:"
echo -e "${BLUE}https://my-project.local.domain.dev${NC}"
read -rp $'Enter your preferred dev domain \n>' dev_domain
echo
echo -e "${WHITE}Local sites${NC}"
echo "Now I need to know about your local sites."
echo " - Each site has a slug and a port."
echo " - The port shuld be different for all your projects."
echo "Enter a project in the format slug:port"
echo "You can add as many as you want, but only one per line."
echo "Just press enter if you are done."
while read -rp ">" site; do
  if [ -z "$site" ]; then
    break
  fi
  sites="$sites $site"
done
echo
echo -e "${WHITE}Your email${NC}"
echo "Let’s Encrypt needs your email address to issue a certificate."
echo "Please use a real one."
read -rp $'Enter your email \n>' email
echo
echo -e "${WHITE}Personal Access Token${NC}"
echo "This is the last question, thanks for your patience."
echo "We need a personal access token for Digitalocean."
echo "It will be stored locally only, and ignored by Git."
echo "Here’s how to get one:"
echo " - Go to your Digitalocean dashboard (https://cloud.digitalocean.com)"
echo " - Under Account, click API and then 'Generate New Token'"
echo " - Copy the generated token"
read -rp $' - Paste it here: \n>' token

echo "$dev_domain"
echo "$sites"
echo "$email"
echo "$token"
